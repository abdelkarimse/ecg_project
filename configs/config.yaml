# configs/config.yaml
# ============================================================
# PTB-XL Edge ECG Challenge — Master Configuration
# ============================================================

data:
  ptbxl_path: "physionet.org/files/ptb-xl/1.0.3"
  sampling_rate: 100                   # Use 100 Hz (not 500 Hz) for edge efficiency
  output_dir: "data/processed"
  splits:
    train: 0.70
    val:   0.15
    test:  0.15
  stratify: true
  random_seed: 42

classes:
  - NORM
  - MI
  - STTC
  - CD
  - HYP

preprocessing:
  target_length: 1000          # 10s × 100Hz = 1000 samples
  bandpass_low: 0.5            # Hz
  bandpass_high: 40.0          # Hz
  notch_freq: 50.0             # Hz (EU powerline; use 60 for US)
  normalize: zscore            # zscore | minmax | none
  leads: all                   # all (12) | limb (6) | precordial (6)

augmentation:
  enabled: true
  gaussian_noise_std: 0.02
  amplitude_scale_range: [0.8, 1.2]
  time_shift_max: 50           # samples
  lead_dropout_prob: 0.1
  baseline_wander_prob: 0.3

model:
  architecture: MobileECG      # MobileECG | ResNet1D | TCN
  input_channels: 12
  input_length: 1000
  num_classes: 5
  # MobileECG specific
  base_filters: 32
  depth_multiplier: 1.0
  dropout: 0.3
  use_attention: true

training:
  epochs: 80
  batch_size: 64
  learning_rate: 1.0e-3
  weight_decay: 1.0e-4
  scheduler: cosine            # cosine | plateau | step
  warmup_epochs: 5
  mixed_precision: true
  early_stopping_patience: 15
  pos_weight_auto: true        # auto-compute from class frequency
  checkpoint_dir: "models/checkpoints"
  best_model_path: "models/best_model.pth"

compression:
  pruning:
    enabled: true
    method: l1_unstructured
    sparsity: 0.40             # Remove 40% of weights
    iterative_steps: 3
  quantization:
    enabled: true
    backend: qnnpack            # qnnpack (ARM) | fbgemm (x86)
    calibration_batches: 100
  knowledge_distillation:
    enabled: false             # Set true if you have a teacher model
    teacher_path: ""
    temperature: 4.0
    alpha: 0.7
  onnx_export:
    enabled: true
    opset: 17
    output_path: "models/ecg_model_int8.onnx"
    optimize: true

evaluation:
  metrics:
    - macro_auc
    - per_class_auc
    - f1_macro
    - accuracy
  threshold: 0.5
  report_path: "models/evaluation_report.json"

inference:
  model_path: "models/ecg_model_int8.onnx"
  device: cpu
  warmup_runs: 3
  benchmark_runs: 50